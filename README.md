
# Лабораторная работа №4  
## Средства постэксплуатации. Анализ Command & Control фреймворка

---

### Выполнили:
- студент 5 курса группы **21-КАС-1**  
  **Гофман Никита Антонович**
- студент 5 курса группы **21-КАС-1**  
  **Аксенов Владислав Вячеславович**

---

## Цель работы

Изучить принципы работы фреймворков постэксплуатации (Command & Control), разобрать архитектуру C2-систем, получить практические навыки развёртывания сервера управления, создания полезной нагрузки, получения Beacon-сессии и анализа возможностей злоумышленника после компрометации целевой системы.

---

## Используемый фреймворк

**Cobalt Strike 4.9**

Фреймворк широко применяется в реальных атаках и предоставляет полный набор средств для постэксплуатации, управления Beacon-агентами, pivoting и lateral movement.

---

## Среда выполнения

### Сервер и клиент C2
- ОС: **Ubuntu**
- Назначение: запуск Team Server и GUI-клиента Cobalt Strike

### Целевая система
- ОС: **Windows 10**
- Назначение: запуск полезной нагрузки и получение Beacon-сессии

Все действия выполнялись **исключительно в виртуальной среде**, виртуальные машины находились в одной локальной сети.

---

## 1. Запуск сервера Cobalt Strike

На сервере Ubuntu был запущен Team Server Cobalt Strike:

![Bash](screenshots/1.jpg)

Сервер ожидает подключение клиента управления.

![Запуск сервера Cobalt Strike](screenshots/01_server_start.png)

---

## 2. Запуск клиентского GUI

На машине Ubuntu был запущен клиент Cobalt Strike:

```bash
./cobaltstrike-client.sh
```

После подключения отображается графический интерфейс управления.

![GUI клиент Cobalt Strike](screenshots/02_client_gui.png)

---

## 3. Создание HTTP Listener

В интерфейсе Cobalt Strike был создан HTTP Listener для приёма Beacon-сессий.

Параметры:

* Тип: HTTP
* Порт: 80

![Создание HTTP Listener](screenshots/03_listener_http.png)

---

## 4. Генерация полезной нагрузки

Была создана полезная нагрузка типа **Windows Stager Payload**.

### Упомянутые типы payload:

* Windows Stager Payload
* Windows Stageless Payload
* HTML Application
* Office Macro

Stager используется для загрузки основного Beacon с сервера.

![Генерация Windows Stager Payload](screenshots/04_payload_windows_stager.png)

---

## 5. Получение Beacon-сессии

После запуска payload на Windows 10 была получена Beacon-сессия.

![Полученная Beacon-сессия](screenshots/05_beacon_session.png)

---

## 6. Работа с Beacon через CLI

Через CLI-интерфейс Beacon оператор получает управление системой.

Пример выполнения команд:

```text
beacon> shell
beacon> systeminfo
```

Команда `systeminfo` позволяет определить версию ОС, архитектуру и системные параметры.

![CLI Beacon: shell и systeminfo](screenshots/06_beacon_cli_shell_systeminfo.png)

---

## 7. Работа с процессами

С помощью команды `ps` оператор получает список процессов целевой системы.

Доступные действия:

* завершение процессов;
* внедрение Beacon;
* внедрение shellcode;
* запуск процессов с другими правами.

![Список процессов](screenshots/07_process_list.png)

---

## 8. Инжект Beacon в процесс

Beacon может быть внедрён в легитимный процесс (например, `explorer.exe`) для маскировки и повышения устойчивости.

![Инжект Beacon в процесс](screenshots/08_process_injection.png)

---

## 9. Контекстное меню Beacon (Explore)

При нажатии ПКМ по Beacon доступны функции:

* Desktop (VNC)
* File Browser
* Process Browser
* Net View
* Port Scan
* Screenshot
* Browser Pivot

![Контекстное меню Beacon](screenshots/09_explore_menu.png)

---

## 10. Pivoting и SOCKS Proxy

Beacon позволяет развернуть SOCKS-прокси:

```text
beacon> socks 1080
```

Pivoting используется для доступа к внутренним сегментам сети жертвы и дальнейших атак с использованием proxychains.

![SOCKS Pivoting](screenshots/10_socks_pivot.png)

---

## Вывод

В ходе выполнения лабораторной работы были изучены принципы работы C2-фреймворков и практические аспекты постэксплуатации. Был выполнен запуск сервера и клиента Cobalt Strike на Ubuntu, создан listener, сгенерирована полезная нагрузка для Windows 10 и получена Beacon-сессия.

В процессе работы были рассмотрены возможности злоумышленника после компрометации системы: выполнение команд, управление процессами, внедрение кода, pivoting и проксирование трафика. Лабораторная работа позволила на практике понять архитектуру C2-систем и сценарии их использования.

